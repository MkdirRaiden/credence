model IdempotencyRecord {
  // Core fields
  id             String            @id @default(uuid())
  scope          IdempotencyScope
  idempotencyKey String
  status         IdempotencyStatus @default(STARTED)

  // Optional fields for additional safety & debugging
  fingerprint  String?
  responseHash String?
  lockedAt     DateTime?
  expiresAt    DateTime?

  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Enforce uniqueness of (scope, idempotencyKey)
  @@unique([idempotencyKey], name: "uniq_idempotency_key")
  @@index([updatedAt])
}
